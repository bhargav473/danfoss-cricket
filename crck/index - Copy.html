<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Player Betting - IPL Style UI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { background:#f5f7fb; }
    .top-logos { overflow-x:auto; white-space:nowrap; padding:10px 0; }
    .logo { display:inline-block; width:90px; height:60px; margin:0 8px; object-fit:contain; cursor:pointer; opacity:1; transition:opacity .2s, transform .12s; }
    .logo.disabled { opacity:.35; cursor:not-allowed; }
    .layout { height:75vh; }
    .left-col { overflow:auto; height:100%; padding-right:8px; }
    .players-table tbody tr { cursor:pointer; }
    .players-table tbody tr.selected { background:#e9f5ff; }
    .center-panel { display:flex; flex-direction:column; align-items:center; justify-content:center; border-left:1px solid #ddd; border-right:1px solid #ddd; background:#fff; padding:16px; height:100%; }
    .leader-card { width:100%; text-align:center; }
    .leader-image { width:120px; height:120px; object-fit:cover; border-radius:8px; border:2px solid #eee; }
    .right-col { padding:12px; height:100%; overflow:auto; background:#fff; }
    .leader-item.disabled { opacity:.5; pointer-events:none; }
    .info-bar { background:#fff; padding:12px; border-top:3px solid #0d6efd; text-align:center; margin-top:12px; }
    @media(max-width:991px){ .layout{height:auto} .left-col{max-height:40vh} }
  </style>
</head>
<body>
  <div class="container-fluid mt-3">

    <!-- Nav Tabs -->
    <ul class="nav nav-tabs" id="mainTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="betting-tab" data-bs-toggle="tab" data-bs-target="#bettingTab" type="button" role="tab">Betting Dashboard</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="teams-tab" data-bs-toggle="tab" data-bs-target="#teamsTab" type="button" role="tab">Teams Summary</button>
      </li>
    </ul>

    <div class="tab-content mt-3">
      <!-- Betting Tab -->
      <div class="tab-pane fade show active" id="bettingTab" role="tabpanel">
        <div class="card p-2 mb-3">
          <div class="top-logos" id="logosRow"></div>
        </div>

        <div class="row g-0 layout">
          <!-- Left: Players list -->
          <div class="col-lg-5 col-md-6 left-col">
            <div class="card h-100">
              <div class="card-body p-2">
                <h5 class="card-title">Team Squad</h5>
                <div class="table-responsive" style="max-height:62vh;">
                  <table class="table table-sm table-hover players-table">
                    <thead class="table-light sticky-top">
                      <tr>
                        <th>#</th>
                        <th>Player Name</th>
                        <th>Bet Amount</th>
                        <th>Assigned Leader</th>
                      </tr>
                    </thead>
                    <tbody id="playersTbody"></tbody>
                  </table>
                </div>

                <div class="row mt-2">
                  <div class="col-12 col-md-6 mb-2">
                    <input id="betAmountInput" type="number" class="form-control" placeholder="Enter amount" min="1">
                  </div>
                  <div class="col-12 col-md-6 mb-2">
                    <button id="assignBtn" class="btn btn-primary w-100">Assign to Selected Leader</button>
                  </div>
                  <div class="col-12">
                    <small class="text-muted">Select a player (row) and a leader (right). Then enter amount and click Assign.</small>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Center: Selected player preview -->
          <div class="col-lg-3 col-md-6 center-panel">
            <div class="leader-card">
              <h5 class="m-0 mb-2">Player Name and details</h5>
              <h4 id="centerPlayerName">Select a Player</h4>
              <img id="centerPlayerImg" class="leader-image my-2" src="images/placeholder-player.jpg" alt="Player image">
              <div>
                <p class="mb-1"><strong>Bet Amount:</strong> ₹<span id="centerPlayerBet">0</span></p>
                <p class="mb-1"><strong>Assigned Leader:</strong> <span id="centerPlayerLeader">—</span></p>
                <p class="text-muted small" id="centerPlayerNote">Click a player from the list to view details.</p>
              </div>
            </div>
          </div>

          <!-- Right: Leader list -->
          <div class="col-lg-4 col-md-12 right-col">
            <div id="leadersList" class="list-group mb-3"></div>

            <div class="card p-2">
              <h6 class="card-title">Selected leader details</h6>
              <div id="selectedLeaderDetails">None</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Teams Summary Tab -->
      <div class="tab-pane fade" id="teamsTab" role="tabpanel">
        <div class="card p-3">
          <h5>Total Teams: <span id="totalTeamsCount"></span></h5>
          <div id="teamsSummaryList"></div>
        </div>
      </div>
    </div>

    <div class="info-bar mt-3">
      <h5 class="mb-0">IPL-style Player Betting Dashboard</h5>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const STARTING_BALANCE = 100000;
  const BASE_BID_AMOUNT = 5000;
  const TOTAL_PLAYERS_TO_AUCTION = 6;

  const leaders = [
    { id: 1, name: "MS Dhoni", amount: STARTING_BALANCE, img: "images/leaders/leader1.jpg", logo: "images/leaders/logo1.png" },
    { id: 2, name: "Virat Kohli", amount: STARTING_BALANCE, img: "images/leaders/leader2.jpg", logo: "images/leaders/logo2.png" },
    { id: 3, name: "Rohit Sharma", amount: STARTING_BALANCE, img: "images/leaders/leader3.jpg", logo: "images/leaders/logo3.png" },
    { id: 4, name: "KL Rahul", amount: STARTING_BALANCE, img: "images/leaders/leader4.jpg", logo: "images/leaders/logo4.png" },
    { id: 5, name: "David Warner", amount: STARTING_BALANCE, img: "images/leaders/leader5.jpg", logo: "images/leaders/logo5.png" },
    { id: 6, name: "Shreyas Iyer", amount: STARTING_BALANCE, img: "images/leaders/leader6.jpg", logo: "images/leaders/logo6.png" },
    { id: 7, name: "Hardik Pandya", amount: STARTING_BALANCE, img: "images/leaders/leader7.jpg", logo: "images/leaders/logo7.png" }
  ];

  const players = [
    { id: 1, name: "Player 1", img: "images/players/player1.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
    { id: 2, name: "Player 2", img: "images/players/player2.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
    { id: 3, name: "Player 3", img: "images/players/player3.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
    { id: 4, name: "Player 4", img: "images/players/player4.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
    { id: 5, name: "Player 5", img: "images/players/player5.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
    { id: 6, name: "Player 6", img: "images/players/player6.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null }
  ];

  let selectedPlayerId = null;
  let selectedLeaderId = null;

  function renderLogos() {
    const logosRow = document.getElementById('logosRow');
    logosRow.innerHTML = '';
    leaders.forEach(l => {
      const img = document.createElement('img');
      img.src = l.logo;
      img.className = 'logo' + (l.amount <= 0 ? ' disabled' : '');
      img.title = `${l.name} — ₹${l.amount}`;
      img.addEventListener('click', () => {
        if (l.amount <= 0) return;
        selectLeader(l.id);
      });
      logosRow.appendChild(img);
    });
  }

  function renderLeadersList() {
    const list = document.getElementById('leadersList');
    list.innerHTML = '';
    leaders.forEach(l => {
      const disabled = l.amount <= 0;
      const item = document.createElement('label');
      item.className = 'list-group-item d-flex justify-content-between align-items-center ' + (disabled ? 'leader-item disabled' : '');
      item.innerHTML = `
        <div>
          <input class="form-check-input me-2" type="radio" name="leaderRadio" value="${l.id}" ${disabled ? 'disabled' : ''}>
          <strong>${l.name}</strong>
        </div>
        <div class="text-end">
          <div>₹<span id="leader-amt-${l.id}">${l.amount}</span></div>
        </div>
      `;
      item.querySelector('input').addEventListener('change', () => selectLeader(l.id));
      list.appendChild(item);
    });
    updateCenterLeaderPanel();
  }

  function renderPlayersTable() {
    const tbody = document.getElementById('playersTbody');
    tbody.innerHTML = '';
    players.forEach(p => {
      const tr = document.createElement('tr');
      if (selectedPlayerId === p.id) tr.classList.add('selected');
      tr.innerHTML = `
        <td>${p.id}</td>
        <td>${p.name}</td>
        <td>₹<span id="player-bet-${p.id}">${p.betAmount}</span></td>
        <td id="player-assigned-${p.id}">${p.assignedLeaderId ? leaders.find(l=>l.id===p.assignedLeaderId).name : '—'}</td>
      `;
      tr.addEventListener('click', () => {
        selectedPlayerId = p.id;
        document.getElementById('betAmountInput').value = BASE_BID_AMOUNT; // Auto fill base bid
        highlightSelectedPlayer();
      });
      tbody.appendChild(tr);
    });
  }

  function highlightSelectedPlayer() {
    document.querySelectorAll('.players-table tbody tr').forEach(row => row.classList.remove('selected'));
    if (selectedPlayerId) {
      const row = document.querySelector(`#playersTbody tr:nth-child(${selectedPlayerId})`);
      if (row) row.classList.add('selected');
    }
    updateCenterPlayerPanel();
  }

  function updateCenterLeaderPanel() {
    if (selectedLeaderId) {
      const l = leaders.find(x => x.id === selectedLeaderId);
      document.getElementById('selectedLeaderDetails').innerHTML = `
        <p class="mb-0"><strong>${l.name}</strong></p>
        <p class="mb-0 small">Balance: ₹${l.amount}</p>
        <img src="${l.img}" class="leader-image mt-2" alt="${l.name}">
      `;
    } else {
      document.getElementById('selectedLeaderDetails').innerHTML = 'None';
    }
  }

  function updateCenterPlayerPanel() {
    const p = players.find(x => x.id === selectedPlayerId);
    if (p) {
      document.getElementById('centerPlayerName').textContent = p.name;
      document.getElementById('centerPlayerImg').src = p.img;
      document.getElementById('centerPlayerBet').textContent = p.betAmount;
      document.getElementById('centerPlayerLeader').textContent = p.assignedLeaderId ? leaders.find(l => l.id === p.assignedLeaderId).name : '—';
      document.getElementById('centerPlayerNote').textContent = p.assignedLeaderId ? 'Player is assigned to a leader.' : 'Player not yet assigned.';
    }
  }

  function selectLeader(id) {
    selectedLeaderId = id;
    document.querySelectorAll('input[name="leaderRadio"]').forEach(r => {
      r.checked = parseInt(r.value) === id;
    });
    updateCenterLeaderPanel();
  }

  function assignToSelectedLeader() {
    const amt = parseInt(document.getElementById('betAmountInput').value, 10);
    if (!selectedPlayerId || !selectedLeaderId || !amt || amt < BASE_BID_AMOUNT) return;

    const totalAssigned = players.filter(p => p.assignedLeaderId !== null).length;
    if (totalAssigned >= TOTAL_PLAYERS_TO_AUCTION) {
      alert(`Auction limit reached (${TOTAL_PLAYERS_TO_AUCTION} players).`);
      return;
    }

    const leader = leaders.find(l => l.id === selectedLeaderId);
    if (amt > leader.amount) {
      alert("Not enough balance!");
      return;
    }

    leader.amount -= amt;
    const player = players.find(p => p.id === selectedPlayerId);
    player.betAmount = amt;
    player.assignedLeaderId = leader.id;

    renderPlayersTable();
    renderLeadersList();
    renderTeamsSummary();
    updateCenterLeaderPanel();
    updateCenterPlayerPanel();
    document.getElementById('betAmountInput').value = '';
  }

  function renderTeamsSummary() {
    document.getElementById('totalTeamsCount').textContent = leaders.length;
    const summaryDiv = document.getElementById('teamsSummaryList');
    summaryDiv.innerHTML = '';
    leaders.forEach(team => {
      const teamPlayers = players.filter(p => p.assignedLeaderId === team.id);
      const card = document.createElement('div');
      card.className = 'card mb-2';
      card.innerHTML = `
        <div class="card-body">
          <h6 class="card-title">${team.name} (${teamPlayers.length} players)</h6>
          ${teamPlayers.length > 0 ? 
            `<ul class="mb-0">${teamPlayers.map(p => `<li>${p.name} — ₹${p.betAmount}</li>`).join('')}</ul>` 
            : '<small class="text-muted">No players assigned</small>'}
        </div>
      `;
      summaryDiv.appendChild(card);
    });
  }

  document.getElementById('assignBtn').addEventListener('click', assignToSelectedLeader);
  renderPlayersTable();
  renderLeadersList();
  renderLogos();
  renderTeamsSummary();
</script>
</body>
</html>
