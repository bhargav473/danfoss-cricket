<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Player Betting - IPL Style UI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <style>
    body { 
      /* pick one of the two: single image OR responsive image-set */
      /* Single image: */
      background-image: url("images/bg2.png");

      /* Optional: responsive sources (modern browsers) */
      /* background-image: image-set(
        url("images/bg-1280.jpg") 1x,
        url("images/bg-2560.jpg") 2x
      ); */

      background-position: center center;
      background-repeat: no-repeat;
      background-attachment: fixed;     /* parallax-like feel; remove on mobile if janky */
      background-size: cover;     }
    .top-logos { overflow-x:auto; white-space:nowrap; padding:10px 0; }
    .logo { display:inline-block; width:90px; height:60px; margin:0 8px; object-fit:contain; cursor:pointer; opacity:1; transition:opacity .2s, transform .12s; }
    .logo.disabled { opacity:.35; cursor:not-allowed; }
    .layout { height:75vh; }
    .left-col {  height:100%; padding-right:8px; }
    .players-table tbody tr { cursor:pointer; }
    .players-table tbody tr.selected { background:#e15a5a; }
    .center-panel { display:flex; flex-direction:column; align-items:center; justify-content:center; ; background-color: transparent;color:white; padding:16px; height:100%; }
    .leader-image { width:250px; height: 250px;  max-width: 100%; border-radius:8px; border:2px solid #eee; }
    /* .right-col { padding:12px; height:100%; overflow:auto; background:#fff; } */
    .leader-item.disabled { opacity:.5; pointer-events:none; }
    .info-bar { background-color: rgba(0, 0, 0, 0.5); padding:12px; border-top:1px solid #e1e1e1; text-align:center; margin-top:12px; color: #ffffff;}
    @media(max-width:991px){ .layout{height:auto} .left-col{max-height:40vh} }
.players-table,
.players-table th,
.players-table td,
.players-table thead {
  background-color: transparent !important;  }
.players-table,
.players-table th,
.players-table td,
.players-table thead {
  background-color: transparent !important;  color: white !important;}
.players-table thead{
  background-color:red!important
}
.form-check-input:checked {
    background-color: #fc0000;
    border-color: #ffffff;
}
.form-check-input{
    border: var(--bs-border-width) solid #ffffff;
}
.list-group-item{
   background-color: rgba(0, 0, 0, 0.5);  color: white !important;
}
 .card{background-color: rgba(0, 0, 0, 0.5);color:white ;}
 .btcolor{
  background-color: #fc0000!important;
 }
  </style>
</head>
<body>
<div class="container-fluid mt-3">

  <!-- Nav Tabs -->
  <ul class="nav nav-tabs" id="mainTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="betting-tab" data-bs-toggle="tab" data-bs-target="#bettingTab" type="button" role="tab">Betting Dashboard</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="teams-tab" data-bs-toggle="tab" data-bs-target="#teamsTab" type="button" role="tab" style="color:white ;background: transparent;">Teams Summary</button>
    </li>
  </ul>

  <div class="tab-content mt-3">
    <!-- Betting Tab -->
    <div class="tab-pane fade show active" id="bettingTab" role="tabpanel">
      <div class="card p-2 mb-3">
        <div class="top-logos" id="logosRow"></div>
      </div>

      <div class="row g-0 layout">
        <!-- Left: Players list -->
        <div class="col-lg-5 col-md-6 left-col">
          <div class="card h-100">
            <div class="card-body p-2">
              <h5 class="card-title">Team Squad</h5>
              <div class="table-responsive" style="max-height:62vh;">
                <table class="table table-sm table-hover players-table bg-table bg-transparent text-white">
                  <thead class="table-light sticky-top bg-transparent text-white">
                    <tr>
                      <th>#</th>
                      <th>Player Name</th>
                      <th>Bet Amount</th>
                      <th>Assigned Leader</th>
                    </tr>
                  </thead>
                  <tbody id="playersTbody"></tbody>
                </table>
              </div>

              <div class="row mt-2">
                <div class="col-12 col-md-6 mb-2">
                  <input id="betAmountInput" type="number" class="form-control" placeholder="Enter amount" min="1">
                </div>
                <div class="col-12 col-md-6 mb-2">
                  <button id="assignBtn" class="btn btn-primary w-100">Assign to Selected Leader</button>
                </div>
                <div class="col-12">
                  <small class="text-muted">Select a player (row) and a leader (right). Then enter amount and click Assign.</small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Center: Selected player preview -->
        <div class="col-lg-3 col-md-6 center-panel">
          <div class="leader-card ">
            <h5 class="m-0 mb-2">Player Name and details</h5>
            <h4 id="centerPlayerName">Select a Player</h4>
            <p class="mb-1 text-muted" id="centerPlayerRole" style="color: white!important;">—</p>
            <img id="centerPlayerImg" class="leader-image my-2" src="images/placeholder-player.jpg" alt="Player image">
            <div>
              <p class="mb-1"><strong>Bet Amount:</strong> ₹<span id="centerPlayerBet">0</span></p>
              <p class="mb-1"><strong>Assigned Leader:</strong> <span id="centerPlayerLeader">—</span></p>
              <p class="text-muted small" id="centerPlayerNote" style="color: #ffffff!important;" >Click a player from the list to view details.</p>
            </div>
          </div>
        </div>

        <!-- Right: Leader list -->
        <div class="col-lg-4 col-md-12 right-col ">
          <div id="leadersList" class="list-group mb-3"></div>
          <div class="card p-2">
            <h6 class="card-title">Selected leader details</h6>
            <div id="selectedLeaderDetails">None</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Teams Summary Tab -->
    <div class="tab-pane fade" id="teamsTab" role="tabpanel">
      <div class="card p-3">
        <h5>Total Teams: <span id="totalTeamsCount"></span></h5>
        <div id="teamsSummaryList"></div>
        <button class="btn btn-success mt-3 btcolor" onclick="downloadTeamsSummary()">Download Excel</button>
      </div>
    </div>
  </div>

  <div class="info-bar mt-3">
    <h5 class="mb-0">IPL-style Player Betting Dashboard</h5>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
const STARTING_BALANCE = 1000000;
const BASE_BID_AMOUNT = 50000;

const leaders = [
    { id: 1, name: "Aravindkumar", amount: STARTING_BALANCE, img: "images/leaders/aravindkumar.jpg", logo: "images/leaders/logo1.png" },
    { id: 2, name: "M Karthickmanoj", amount: STARTING_BALANCE, img: "images/leaders/m karthickmanoj.jpeg", logo: "images/leaders/logo2.png" },
    { id: 3, name: "Vignesh Kumar P", amount: STARTING_BALANCE, img: "images/leaders/vignesh kumar p.jpg", logo: "images/leaders/logo3.png" },
    { id: 4, name: "Pasurudeen", amount: STARTING_BALANCE, img: "images/leaders/Pasurudeen.jpeg", logo: "images/leaders/logo4.png" },
    { id: 5, name: "Manikandan V", amount: STARTING_BALANCE, img: "images/leaders/manikandan v.jpg", logo: "images/leaders/logo5.png" },
    { id: 6, name: "Anbarasanmani", amount: STARTING_BALANCE, img: "images/leaders/anbarasanmani.jpg", logo: "images/leaders/logo6.png" }
  ];
 
const players = [
   
 
  { id: 1, name: "Sriram Charxxxxxxxxxi", role: "All rounder", img: "images/players/Sriram Chari.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 2, name: "Vivek", role: "All rounder", img: "images/players/Vivek.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 3, name: "AnandaVenkatesh V", role: "All rounder", img: "images/players/AnandaVenkatesh V.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 4, name: "Franklin Arokiyabritto", role: "All rounder", img: "images/players/Franklin Arokiyabritto.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 5, name: "Alagu Sakthivel", role: "All rounder", img: "images/players/Alagu Sakthivel.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 6, name: "Gokul Jawahar", role: "All rounder", img: "images/players/Gokul Jawahar.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 7, name: "Alfred", role: "All rounder", img: "images/players/Alfred.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 8, name: "Dhanasekaran V", role: "All rounder", img: "images/players/Dhanasekaran V.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 9, name: "k.Vinoth Kumar", role: "All rounder", img: "images/players/k.Vinoth Kumar.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 10, name: "RAJ KUMAR M", role: "All rounder", img: "images/players/RAJ KUMAR M.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 11, name: "siva", role: "All rounder", img: "images/players/siva.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 12, name: "Loganathan K", role: "Bowler", img: "images/players/Loganathan K.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 13, name: "Monika", role: "Batsman", img: "images/players/Monika.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 14, name: "B Karthikeyan", role: "Batsman", img: "images/players/B Karthikeyan.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 15, name: "Manikandan B", role: "All rounder", img: "images/players/Manikandan B.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 16, name: "Kennady J", role: "All rounder", img: "images/players/Kennady J.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 17, name: "Ezhilarasan D", role: "All rounder", img: "images/players/Ezhilarasan D.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 18, name: "Bharath Kumar R", role: "All rounder", img: "images/players/Bharath Kumar R.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 19, name: "Praveen Jeyswanth", role: "All rounder", img: "images/players/Praveen Jeyswanth.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 20, name: "Madhumitha S", role: "Batsman", img: "images/players/Madhumitha S.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 21, name: "Adalarasu", role: "All rounder", img: "images/players/Adalarasu.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 22, name: "Vikalp Patodia", role: "All rounder", img: "images/players/Vikalp Patodia.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 23, name: "Soundhararajan J", role: "Bowler", img: "images/players/Soundhararajan J.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 24, name: "Sindhu Muthusamy", role: "All rounder", img: "images/players/Sindhu Muthusamy.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 25, name: "Durgesh Gowtham S", role: "All rounder", img: "images/players/Durgesh Gowtham S.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 26, name: "Ashok Kaliyaperumal", role: "Bowler", img: "images/players/Ashok Kaliyaperumal.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 27, name: "Suresh Kumar", role: "All rounder", img: "images/players/Suresh Kumar.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 28, name: "Arun Viswanathan", role: "Batsman", img: "images/players/Arun Viswanathan.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 29, name: "sudharsan.B", role: "All rounder", img: "images/players/sudharsan.B.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 30, name: "sarath kumar chinnappa", role: "All rounder", img: "images/players/sarath kumar chinnappa.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 31, name: "Dhanya R", role: "Bowler", img: "images/players/Dhanya R.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 32, name: "Stalin Regu C", role: "Batsman", img: "images/players/Stalin Regu C.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 33, name: "Manojkanth", role: "All rounder", img: "images/players/Manojkanth.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 34, name: "Manogj Sundaresan", role: "All rounder", img: "images/players/Manogj Sundaresan.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 35, name: "Harish R", role: "All rounder", img: "images/players/Harish R.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 36, name: "Ranjithkumar C", role: "All rounder", img: "images/players/Ranjithkumar C.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 37, name: "Dhanabal", role: "All rounder", img: "images/players/Dhanabal.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 38, name: "Kalaivanan S", role: "Batsman", img: "images/players/Kalaivanan S.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 39, name: "Subramani G", role: "Batsman", img: "images/players/Subramani G.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 40, name: "Santhosh K R", role: "Batsman", img: "images/players/Santhosh K R.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 41, name: "Subha Kalyanasundaram", role: "All rounder", img: "images/players/Subha Kalyanasundaram.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 42, name: "Manimegalai M", role: "All rounder", img: "images/players/Manimegalai M.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 43, name: "Rajaganapathy", role: "Batsman", img: "images/players/Rajaganapathy.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 44, name: "Charles", role: "Batsman", img: "images/players/Charles.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 45, name: "Mohit Anand Rastogi", role: "All rounder", img: "images/players/Mohit Anand Rastogi.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 46, name: "Akshaya", role: "Batsman", img: "images/players/Akshaya.jpg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 47, name: "Bharanidharan", role: "Bowler", img: "images/players/Bharanidharan.png", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null },
  { id: 48, name: "Dinesh Kumar", role: "All rounder", img: "images/players/Dinesh Kumar.jpeg", betAmount: BASE_BID_AMOUNT, assignedLeaderId: null }
 
    // ... rest of your players
  ];

let selectedPlayerId = null;
let selectedLeaderId = null;

function saveData() {
  sessionStorage.setItem('playersData', JSON.stringify(players));
  sessionStorage.setItem('leadersData', JSON.stringify(leaders));
}

function loadData() {
  const storedPlayers = sessionStorage.getItem('playersData');
  const storedLeaders = sessionStorage.getItem('leadersData');
  if (storedPlayers && storedLeaders) {
    players.splice(0, players.length, ...JSON.parse(storedPlayers));
    leaders.splice(0, leaders.length, ...JSON.parse(storedLeaders));
  }
}

function renderLogos() {
  const logosRow = document.getElementById('logosRow');
  logosRow.innerHTML = '';
  leaders.forEach(l => {
    const img = document.createElement('img');
    img.src = l.logo;
    img.className = 'logo' + (l.amount <= 0 ? ' disabled' : '');
    img.title = `${l.name} — ₹${l.amount}`;
    img.addEventListener('click', () => { if (l.amount > 0) selectLeader(l.id); });
    logosRow.appendChild(img);
  });
}

function renderLeadersList() {
  const list = document.getElementById('leadersList');
  list.innerHTML = '';
  leaders.forEach(l => {
    const disabled = l.amount <= 0;
    const item = document.createElement('label');
    item.className = 'list-group-item d-flex justify-content-between align-items-center ' + (disabled ? 'leader-item disabled' : '');
    item.innerHTML = `
      <div>
        <input class="form-check-input me-2" type="radio" name="leaderRadio" value="${l.id}" ${disabled ? 'disabled' : ''}>
        <strong>${l.name}</strong>
      </div>
      <div class="text-end">
        <div>₹<span id="leader-amt-${l.id}">${l.amount}</span></div>
      </div>
    `;
    item.querySelector('input').addEventListener('change', () => selectLeader(l.id));
    list.appendChild(item);
  });
  updateCenterLeaderPanel();
}

function renderPlayersTable() {
  const tbody = document.getElementById('playersTbody');
  tbody.innerHTML = '';
  players.forEach((p, index) => {
    const tr = document.createElement('tr');
    if (selectedPlayerId === p.id) tr.classList.add('selected');
    tr.dataset.playerId = p.id; // store id in data attribute
    tr.innerHTML = `
      <td>${p.id}</td>
      <td>${p.name}</td>
      <td>₹<span id="player-bet-${p.id}">${p.betAmount}</span></td>
      <td id="player-assigned-${p.id}">${p.assignedLeaderId ? leaders.find(l=>l.id===p.assignedLeaderId).name : '—'}</td>
    `;
    tr.addEventListener('click', () => {
      selectedPlayerId = p.id;
      document.getElementById('betAmountInput').value = BASE_BID_AMOUNT;
      highlightSelectedPlayer();
    });
    tbody.appendChild(tr);
  });
}

function highlightSelectedPlayer() {
  document.querySelectorAll('.players-table tbody tr').forEach(row => row.classList.remove('selected'));
  if (selectedPlayerId) {
    const row = document.querySelector(`tr[data-player-id="${selectedPlayerId}"]`);
    if (row) row.classList.add('selected');
  }
  updateCenterPlayerPanel();
}

function updateCenterLeaderPanel() {
  if (selectedLeaderId) {
    const l = leaders.find(x => x.id === selectedLeaderId);
    document.getElementById('selectedLeaderDetails').innerHTML = `
      <p class="mb-0"><strong>${l.name}</strong></p>
      <p class="mb-0 small">Balance: ₹${l.amount}</p>
      <img src="${l.img}" class="leader-image mt-2" alt="${l.name}">
    `;
  } else {
    document.getElementById('selectedLeaderDetails').innerHTML = 'None';
  }
}

function updateCenterPlayerPanel() {
  const p = players.find(x => x.id === selectedPlayerId);
  if (p) {
    document.getElementById('centerPlayerName').textContent = p.name;
    document.getElementById('centerPlayerRole').textContent = p.role;
    document.getElementById('centerPlayerImg').src = p.img;
    document.getElementById('centerPlayerBet').textContent = p.betAmount;
    document.getElementById('centerPlayerLeader').textContent = p.assignedLeaderId ? leaders.find(l => l.id === p.assignedLeaderId).name : '—';
    document.getElementById('centerPlayerNote').textContent = p.assignedLeaderId ? 'Player is assigned to a leader.' : 'Player not yet assigned.';
  }
}

function selectLeader(id) {
  selectedLeaderId = id;
  document.querySelectorAll('input[name="leaderRadio"]').forEach(r => r.checked = parseInt(r.value) === id);
  updateCenterLeaderPanel();
}

function assignToSelectedLeader() {
  const amt = parseInt(document.getElementById('betAmountInput').value, 10);
  if (!selectedPlayerId || !selectedLeaderId || !amt || amt < BASE_BID_AMOUNT) return;

  const player = players.find(p => p.id === selectedPlayerId);
  const newLeader = leaders.find(l => l.id === selectedLeaderId);

  if (player.assignedLeaderId !== null && player.assignedLeaderId !== selectedLeaderId) {
    const prevLeader = leaders.find(l => l.id === player.assignedLeaderId);
    prevLeader.amount += player.betAmount;
  }

  if (player.assignedLeaderId === selectedLeaderId) {
    const diff = amt - player.betAmount;
    if (diff > newLeader.amount) { alert("Not enough balance!"); return; }
    newLeader.amount -= diff;
  } else {
    if (amt > newLeader.amount) { alert("Not enough balance!"); return; }
    newLeader.amount -= amt;
  }

  player.betAmount = amt;
  player.assignedLeaderId = newLeader.id;

  renderPlayersTable();
  renderLeadersList();
  renderTeamsSummary();
  updateCenterLeaderPanel();
  updateCenterPlayerPanel();
  document.getElementById('betAmountInput').value = '';

  saveData();
}

function renderTeamsSummary() {
  document.getElementById('totalTeamsCount').textContent = leaders.length;
  const summaryDiv = document.getElementById('teamsSummaryList');
  summaryDiv.innerHTML = '';
  leaders.forEach(team => {
    const teamPlayers = players.filter(p => p.assignedLeaderId === team.id);
    const card = document.createElement('div');
    card.className = 'card mb-2';
    card.innerHTML = `
      <div class="card-body">
        <h6 class="card-title">${team.name} (${teamPlayers.length} players)</h6>
        ${teamPlayers.length > 0 ? 
          `<ul class="mb-0">${teamPlayers.map(p => `<li>${p.name} — ₹${p.betAmount}</li>`).join('')}</ul>` 
          : '<small class="text-muted">No players assigned</small>'}
      </div>
    `;
    summaryDiv.appendChild(card);
  });
}

function downloadTeamsSummary() {
  let data = [];
  leaders.forEach(team => {
    const teamPlayers = players.filter(p => p.assignedLeaderId === team.id);
    if (teamPlayers.length > 0) {
      teamPlayers.forEach(p => { data.push({ Team: team.name, Player: p.name, BetAmount: p.betAmount }); });
    } else {
      data.push({ Team: team.name, Player: "No players assigned", BetAmount: "" });
    }
  });

  const ws = XLSX.utils.json_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "Teams Summary");
  XLSX.writeFile(wb, "Teams_Summary.xlsx");
}

document.getElementById('assignBtn').addEventListener('click', assignToSelectedLeader);

// Initialize
loadData();
renderPlayersTable();
renderLeadersList();
renderLogos();
renderTeamsSummary();
</script>
</body>
</html>
